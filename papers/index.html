<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Papers — A. Laface</title>
  <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
<header>
  <nav>
    <a class="brand" href="../">Antonio&nbsp;Laface</a>
    <a href="./">Papers</a>
    <a href="../arxiv/">arXiv</a>
    <a href="../software/">Software</a>
    <a href="../notes/">Lecture notes</a>
    <a href="../book/">Book</a>
  </nav>
</header>

<main>
  <h1>Published papers</h1>
  <p>This list is fetched live from the public Crossref API. For MathSciNet details, use the MR link beside each item.</p>

  <div id="papers" class="card"><p>Loading…</p></div>

  <p style="font-size:.95em;color:#57606a;margin-top:1rem">
    Data source: Crossref. If something is missing or misattributed, tell me and I’ll fix the filters.
  </p>
</main>

<footer>© <span id="y"></span> Antonio Laface</footer>
<script>document.getElementById('y').textContent = new Date().getFullYear();</script>

<script>
// ---------- Settings ----------
const AUTHOR_FULL = "Antonio Laface";                  // exact author string for client-side filtering
const ROWS = 200;                                      // max items to fetch
// Crossref query: author + sort by issued desc; select only fields we need to keep the payload small.
const crossrefURL = `https://api.crossref.org/works?query.author=${encodeURIComponent(AUTHOR_FULL)}&rows=${ROWS}&sort=issued&order=desc&select=title,author,DOI,URL,issued,container-title,volume,issue,page`;

// ---------- Utils ----------
const esc = s => s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
const yearOf = issued => (issued && issued['date-parts'] && issued['date-parts'][0] && issued['date-parts'][0][0]) || "";

// normalize “Antonio Laface” match among authors returned by Crossref
function hasAuthorMatch(list) {
  if (!Array.isArray(list)) return false;
  return list.some(a => {
    const given = (a.given || "").trim().toLowerCase();
    const family = (a.family || "").trim().toLowerCase();
    const full = (given + " " + family).trim();
    return full === AUTHOR_FULL.toLowerCase();
  });
}

// link to MathSciNet “MR Lookup” (works best when a DOI exists)
function mrLookupLink(doi) {
  if (!doi) return "";
  // We don't embed MathSciNet; we just provide a convenient outbound link.
  const q = encodeURIComponent(doi);
  return `https://mathscinet.ams.org/mathscinet/relay?mr=Lookup&url=https://mathscinet.ams.org/mathscinet/search/publications.html?pg1=DOI&s1=${q}`;
}

// ---------- Fetch & render ----------
fetch(crossrefURL)
  .then(r => r.json())
  .then(data => {
    const items = (data.message && data.message.items) || [];
    // Keep only entries where “Antonio Laface” is clearly an author
    const mine = items.filter(it => hasAuthorMatch(it.author));

    // Build HTML
    const html = mine.map(it => {
      const title = (it.title && it.title[0]) ? it.title[0] : "(untitled)";
      const journal = (it["container-title"] && it["container-title"][0]) ? it["container-title"][0] : "";
      const yr = yearOf(it.issued);
      const vol = it.volume ? ` ${esc(it.volume)}` : "";
      const no = it.issue ? `(${esc(it.issue)})` : "";
      const pp = it.page ? `:${esc(it.page)}` : "";
      const cite = [journal, (vol || no || pp) ? `${vol}${no}${pp}` : ""].filter(Boolean).join(", ");
      const doi = it.DOI || "";
      const url = it.URL || (doi ? `https://doi.org/${doi}` : "");

      const mrURL = mrLookupLink(doi);
      const authors = Array.isArray(it.author) ? it.author.map(a => esc([a.given, a.family].filter(Boolean).join(" "))).join(", ") : "";

      return `
        <div class="card">
          <h3 style="margin-top:0">
            <a href="${esc(url)}" target="_blank" rel="noopener">${esc(title)}</a>
          </h3>
          <p><strong>Authors:</strong> ${authors}</p>
          <p><strong>Journal:</strong> ${esc(cite)} ${yr ? `· <strong>Year:</strong> ${esc(String(yr))}` : ""}</p>
          <p>
            ${doi ? `DOI: <a href="https://doi.org/${esc(doi)}" target="_blank" rel="noopener">${esc(doi)}</a>` : ""}
            ${mrURL ? ` · <a href="${esc(mrURL)}" target="_blank" rel="noopener">MR lookup</a>` : ""}
          </p>
        </div>`;
    }).join("") || "<p>No records found (via Crossref).</p>";

    document.getElementById("papers").innerHTML = html;
  })
  .catch(err => {
    console.error(err);
    document.getElementById("papers").innerHTML =
      `<p>Failed to load from Crossref. You can visit my <a href="https://api.crossref.org/works?query.author=${encodeURIComponent(AUTHOR_FULL)}" target="_blank" rel="noopener">Crossref author search</a> or my <a href="https://www.ams.org/mathscinet" target="_blank" rel="noopener">MathSciNet profile</a> (subscription required).</p>`;
  });
</script>
</body>
</html>
