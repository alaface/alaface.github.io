<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Papers — A. Laface</title>
  <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
<header>
  <nav>
    <a class="brand" href="../">Antonio&nbsp;Laface</a>
    <a href="./">Papers</a>
    <a href="../arxiv/">arXiv</a>
    <a href="../software/">Software</a>
    <a href="../notes/">Lecture notes</a>
    <a href="../book/">Book</a>
  </nav>
</header>

<main>
  <h1>Published papers</h1>
  <p>This page first tries the zbMATH Open API; if unavailable, it falls back to Crossref (filtered by ORCID).</p>
  <div id="papers" class="card"><p>Loading…</p></div>
  <p style="font-size:.95em;color:#57606a;margin-top:1rem">
    Data sources: zbMATH Open (preferred), Crossref (fallback). MR links added when a DOI is available.
  </p>
</main>

<footer>© <span id="y"></span> Antonio Laface</footer>
<script>document.getElementById('y').textContent = new Date().getFullYear();</script>

<script>
const ZB_AUTHOR_CANONICAL = 'Laface, Antonio';     // exact zbMATH author string (surname, given)
const ORCID = '0000-0001-6926-8249';               // your ORCID for precise Crossref filtering
const SIZE = 200;

const esc = s => (s||"").toString().replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
const yearOf = it => it.year || it?.issued?.['date-parts']?.[0]?.[0] || '';
const doiURL = doi => doi ? `https://doi.org/${encodeURIComponent(doi)}` : '';
const mrLookup = doi => doi ? `https://mathscinet.ams.org/mathscinet/relay?mr=Lookup&url=https://mathscinet.ams.org/mathscinet/search/publications.html?pg1=DOI&s1=${encodeURIComponent(doi)}` : '';
const zbDocURL = id => id ? `https://zbmath.org/?q=an:${encodeURIComponent(id)}` : '';
const zbAuthorPage = `https://zbmath.org/authors/?q=au%3A%22${encodeURIComponent(ZB_AUTHOR_CANONICAL)}%22`;

// ---- author match helpers ----
function norm(s){ return (s||"").trim().toLowerCase(); }
function isAntonioLafaceName(given, family){
  return norm(given) === 'antonio' && norm(family) === 'laface';
}
function includesExactZbName(list){
  // zbMATH formats often like "Surname, Given"
  return (list||[]).some(a => {
    const name = typeof a === 'string' ? a : (a.name || [a.first, a.last].filter(Boolean).join(', '));
    return norm(name) === norm(ZB_AUTHOR_CANONICAL) || norm(name) === 'antonio laface' || norm(name) === 'laface, antonio';
  });
}
function includesExactCrossrefAuthor(list){
  return (list||[]).some(a => isAntonioLafaceName(a.given, a.family) || (a.ORCID && a.ORCID.replace(/^https?:\/\/orcid\.org\//,'') === ORCID));
}

function render(items, source){
  if (!items?.length) { document.getElementById('papers').innerHTML = `<p>No records found.</p>`; return; }
  const html = items.map(it => {
    const title = it.title || it.ti || (Array.isArray(it.title)?.[0]) || (Array.isArray(it.titleArr)?.[0]) || "(untitled)";
    const yr = yearOf(it);

    let authors = "";
    if (source === 'zb') {
      const list = it.authors || it.author || it.au || [];
      authors = list.map(a => typeof a === 'string' ? a : (a.name || [a.first, a.last].filter(Boolean).join(' '))).join(', ');
    } else {
      const list = it.author || [];
      authors = list.map(a => [a.given, a.family].filter(Boolean).join(' ')).join(', ');
    }

    const journal = it.journal || it.journal_title || it?.containerTitle || (it['container-title']?.[0]) || '';
    const vol = it.volume || it.vol || '';
    const issue = it.issue || it.no || it['journal-issue']?.issue || '';
    const page = it.pages || it.page || '';
    const citeTail = [vol && ` ${esc(vol)}`, issue && `(${esc(issue)})`, page && `:${esc(page)}`].filter(Boolean).join('');
    const doi = it.doi || (Array.isArray(it.dois)?it.dois[0]:it.DOI) || '';
    const url = it.url || it.link || it.URL || doiURL(doi) || zbDocURL(it.id || it.an);

    return `
      <div class="card">
        <h3 style="margin-top:0"><a href="${esc(url)}" target="_blank" rel="noopener">${esc(title)}</a></h3>
        <p><strong>Authors:</strong> ${esc(authors)}</p>
        <p><strong>Journal:</strong> ${esc(journal)}${citeTail ? esc(citeTail) : ''}${yr ? ` · <strong>Year:</strong> ${esc(String(yr))}` : ''}</p>
        <p>
          ${doi ? `DOI: <a href="${esc(doiURL(doi)))}" target="_blank" rel="noopener">${esc(doi)}</a>` : ''}
          ${doi ? ` · <a href="${esc(mrLookup(doi))}" target="_blank" rel="noopener">MR lookup</a>` : ''}
        </p>
      </div>`;
  }).join('');
  document.getElementById('papers').innerHTML = html;
}

(async function(){
  // ---- 1) Try zbMATH (then filter strictly by exact author) ----
  const zbParams = new URLSearchParams({ q: `au:"${ZB_AUTHOR_CANONICAL}"`, size: String(SIZE), sort: 'year.desc' });
  const ZB_URL = `https://api.zbmath.org/v1/document?${zbParams.toString()}`;

  try {
    const r = await fetch(ZB_URL, { method: 'GET' });
    if (!r.ok) throw new Error('zbMATH HTTP ' + r.status);
    const data = await r.json();
    const raw = data?.data || data?.hits || data?.documents || data?.items || [];
    // keep ONLY items that list the exact author
    const filtered = raw.filter(it => includesExactZbName(it.authors || it.author || it.au));
    if (filtered.length) { render(filtered, 'zb'); return; }
    throw new Error('zbMATH returned no exact matches');
  } catch (e) {
    // ---- 2) Fallback Crossref with ORCID filter (precise) ----
    const crossrefURL = `https://api.crossref.org/works?filter=orcid:${encodeURIComponent(ORCID)}&rows=${SIZE}&sort=issued&order=desc&select=title,author,DOI,URL,issued,container-title,volume,issue,page`;
    try {
      const r2 = await fetch(crossrefURL);
      const j = await r2.json();
      let items = j?.message?.items || [];
      // As an extra guard, keep only entries that include your exact author (or ORCID) in the returned author list
      items = items.filter(it => includesExactCrossrefAuthor(it.author));
      render(items, 'crossref');
    } catch (e2) {
      document.getElementById('papers').innerHTML =
        `<p>Both zbMATH and Crossref are currently unreachable. You can still visit my zbMATH author page:
          <a href="${zbAuthorPage}" target="_blank" rel="noopener">${esc(ZB_AUTHOR_CANONICAL)}</a>.
        </p>`;
    }
  }
})();
</script>
</body>
</html>
